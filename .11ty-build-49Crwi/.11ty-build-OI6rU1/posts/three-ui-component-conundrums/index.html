<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Three UI Component Conundrums</title>
    <meta name="description" content="I really like using React with Styled Components for building effective user interfaces. However I have recently come across three conundrums to solve.">
    <meta property="og:site_name" content="Three UI Component Conundrums">
    <meta property="og:locale" content="en_GB">
    <meta property="og:type" content="website">
    <meta property="og:description" content="I really like using React with Styled Components for building effective user interfaces. However I have recently come across three conundrums to solve.">
    <meta property="og:title" content="Three UI Component Conundrums" />
    <meta property="og:image" content="/img/sharecard-default.png" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@muzzlehatch_" />
    <meta name="twitter:title" content="Three UI Component Conundrums" />
    <meta
      name="twitter:description"
      content="I really like using React with Styled Components for building effective user interfaces. However I have recently come across three conundrums to solve."
    />
    <meta name="twitter:image" content="/img/sharecard-default.png" />
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "NewsArticle",
        "headline": "Three UI Component Conundrums",
        "author": {
          "@type": "Person",
          "name": "Benjamin Read"
        },
        "datePublished": "2020-10-30T15:21:21+01:00",
        "image": "/img/sharecard-default.png"
      }
    </script>
    <link rel="icon" href="/img/icon.png" type="image/x-icon">
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Delicious Reverie">
    <link rel="alternate" href="/feed/feed.json" type="application/json" title="Delicious Reverie">
  </head>
  <body>
    <a id="skiplinks" href="#main">Skip to main content</a>
    <p class="themeswitcher">Choose theme:</p>
    <label class="themeswitcher" for="dark">Light</label>
    <input class="themeswitcher" type="radio" id="light" name="colors" value="light">
    <label  class="themeswitcher" for="dark">Dark</label>
    <input  class="themeswitcher" type="radio" id="dark" name="colors" value="dark">
    <header>
      <div class="container">
        <div class="title home"><a href="/">Delicious Reverie</a></div>
        <p class="subtitle">blog of developer &amp; bookworm benjamin read</p>
        <nav>
          <ul class="list-inline">
            <li class="nav-item">
              <a href="/">Home</a>
            </li>
            <li class="nav-item">
              <a href="/about/">About</a>
            </li>
            <li class="nav-item">
              <a href="/links/">Links</a>
            </li>
            <li class="nav-item">
              <a href="/posts/">Archive</a>
            </li>
            <li class="nav-item">
              <a href="/contact/">Contact</a>
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <main class="main tmpl-post">
      
      <div class="container">
        <h1>Three UI Component Conundrums</h1>

<time datetime="2020-10-30">30 Oct 2020</time><a href="/tags/javascript/" class="post-tag">javascript</a><a href="/tags/computer-science/" class="post-tag">computer science</a>

<p><strong>React combined with Styled Components is a flexible and maintainable way of composing reusable user interfaces for the web. However, every set of tools has as well as awesome features, a few tricky problems to solve. Here are three that I've come across recently.</strong></p>
<h2 id="some-conundrums" tabindex="-1">Some conundrums <a class="direct-link" href="#some-conundrums" aria-hidden="true">#</a></h2>
<h3 id="1.-css-inheritance:-the-conundrum" tabindex="-1">1. CSS inheritance: The conundrum <a class="direct-link" href="#1.-css-inheritance:-the-conundrum" aria-hidden="true">#</a></h3>
<p>The first issue concerns encapsulation. Broadly speaking, the main differing opinions on this argue that the results of your functions should be bound to that function only, and not have any effect on anything outside that variable (this is <em>encapsulation</em>), versus the idea that it's OK for things to <em>inherit</em>, or to have an effect that carries on across multiple functions.</p>
<p>I'm weighing into this discussion on a different level to most. In this post, I'm not talking about encapsulation and inheritance as it pertains to object-oriented programming, although the principles are the same. I'm chiefly interested in UI components, and here I'm going to talk about these principles and how they've impacted my recent work.</p>
<p>The basic tenet of CSS assumes inheritance. It's in the name: <em>Cascading</em> Style Sheets. If you started your web development career from this angle, then you're probably quite used to seeing things like:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">div</span> <span class="token punctuation">{</span><br>  <span class="token property">color</span><span class="token punctuation">:</span> lightblue<span class="token punctuation">;</span><br>  <span class="token property">background-color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token selector">div.banner</span> <span class="token punctuation">{</span><br>  <span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>The <code>div</code> with the class <code>banner</code> will <em>inherit</em> the <code>background-color</code> from the first <code>div</code>. This is a normal way of writing CSS ... <em>if</em> you've had a certain type of introduction to CSS.</p>
<p>At work, I'm using an internal library of components written in Styled Components. This has some really distinct advantages: it's very simple for developers to keep within the brand guidelines, and even very basic elements are <em>encapsulated</em>, that is, they can be composed together without any unexpected side effects.</p>
<p>But this has also led us into some complications... here's the conundrum and solution for two of them:</p>
<p>Here's a real-world example in React using the CSS-in-JS library Styled Components:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// declared in an external library</span><br><span class="token keyword">const</span> Text <span class="token operator">=</span> styled<span class="token punctuation">.</span>p<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    color: lightblue;<br></span><span class="token template-punctuation string">`</span></span><br><br><span class="token comment">// declared in an external library</span><br><span class="token keyword">const</span> <span class="token function-variable function">Card</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><br>    <span class="token operator">&lt;</span>SCard<span class="token operator">></span><br>        <span class="token operator">&lt;</span>Text <span class="token keyword">as</span><span class="token operator">=</span><span class="token string">"p"</span> color<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">default</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Text<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>SCard<span class="token operator">></span><br><span class="token punctuation">)</span><br><br><span class="token comment">// my override</span><br><span class="token keyword">const</span> SCard <span class="token operator">=</span> <span class="token function">styled</span><span class="token punctuation">(</span>Card<span class="token punctuation">)</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    p {<br>        color: green;<br>    }<br></span><span class="token template-punctuation string">`</span></span></code></pre>
<p>In this example, no inheritance will occur, because the style applied directly to <code>&lt;Text/&gt;</code> has higher priority than the <code>color</code> declaration on <code>&lt;SCard/&gt;</code>.</p>
<p>So, how do I make the text in <code>&lt;SCard/&gt;</code> the colour I need it to be? At this point, I have to either set the API of the <code>&lt;Text/&gt;</code> component to recieve a <code>color</code> property (if you have access to that, which I didn't), or override the colour in <code>&lt;SCard/&gt;</code> using an <code>!important</code> declaration.</p>
<h3 id="1:-css-inheritance:-the-solution" tabindex="-1">1: CSS inheritance: The solution <a class="direct-link" href="#1:-css-inheritance:-the-solution" aria-hidden="true">#</a></h3>
<p>In this instance, our solution was to change the API of <code>&lt;Text /&gt;</code> so that by default the colour was <code>inherit</code>. This made it possible for both approaches: inheritance where necessary using CSS, or by adding a colour directly to the Text component using it's <code>color</code> property.</p>
<h3 id="2:-large-pages:-the-conundrum" tabindex="-1">2: Large pages: the conundrum <a class="direct-link" href="#2:-large-pages:-the-conundrum" aria-hidden="true">#</a></h3>
<p>I'm not sure what the average number of DOM elements on a page is. We have some pages that have a lot of elements, around 1,100. Just about every element is a separate <code>React.Component</code>, and due to design variation, we extend a lot of them in a similar way to this:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> Card <span class="token keyword">from</span> <span class="token string">"component-library"</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> SCard <span class="token operator">=</span> <span class="token function">styled</span><span class="token punctuation">(</span>Card<span class="token punctuation">)</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>  background: lightblue;<br></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code></pre>
<p>This seems to wrap the component in a <code>React.Context</code> that serves to keep track of the original component ... after all, if the <em>original</em> component changes, how will we know to update this extended component?</p>
<p>On the pages where there are a lot of these extended components, we are seeing a significant drop in performance. I'm assuming it's because of the extra dependencies involved (1. the original component, 2. the <code>React.Context</code> wrapper, 3. the new component).</p>
<h3 id="2:-large-pages:-the-solution(s)" tabindex="-1">2: Large pages: the solution(s) <a class="direct-link" href="#2:-large-pages:-the-solution(s)" aria-hidden="true">#</a></h3>
<p>We haven't solved this yet, but I found it particularly interesting that there was a significant drop in performance, proving to be a noticeable factor in how many conversions we see from those pages when compared to a previous iteration of the application.</p>
<p>I can think of a few options:</p>
<ol>
<li>Switch to a css-in-js solution with lower (or zero) runtime, like Linaria</li>
<li>Keep Styled Components but export CSS strings alongside the components so that we can extend them using CSS only (in most, the components' APIs don't change significantly)</li>
<li>Rationalise the design so that it uses styles that already exist in the library</li>
</ol>
<p>What would you choose?</p>
<h3 id="3:-markdown-content:-the-conundrum" tabindex="-1">3: Markdown content: the conundrum <a class="direct-link" href="#3:-markdown-content:-the-conundrum" aria-hidden="true">#</a></h3>
<p>This one is related to the above, but we are also using these components in Markdown content we pull in from our CMS. So for each <code>&lt;p&gt;</code> tag that's generated from the Markdown, we use our libraries' <code>&lt;Text /&gt;</code> component.</p>
<p>This hasn't been an issue yet, but I can see one day we're going to have an extremely long page of content that uses many elements that also impacts page performance.</p>
<h3 id="3:-markdown-content:-the-possible-solution(s)" tabindex="-1">3: Markdown content: the possible solution(s) <a class="direct-link" href="#3:-markdown-content:-the-possible-solution(s)" aria-hidden="true">#</a></h3>
<p>We're probably going to have to use one of the 3 solutions in the previous conundrum to solve this one too.</p>
<h2 id="conclusion" tabindex="-1">Conclusion <a class="direct-link" href="#conclusion" aria-hidden="true">#</a></h2>
<p>I have tremendous confidence in css-in-js, and believe if you're using React, Styled Components is a great, broadly performant solution that gets most people where they need to be.</p>
<p>However, it has to be noted that there is a runtime overhead that increases with every component you extend.</p>
<p>I am interested to see if there's a way of compiling all components at build time and avoiding that <code>React.Context</code> link, since in our case we don't expect the original components to change after that.</p>
<p>And I'm interested to see whether other solutions, like Linaria, can provide a solution we can utilise in the future.</p>

<hr>
<ul><li>Next: <a href="/posts/javascript-cms-landscape/">The JavaScript CMS Landscape</a></li><li>Previous: <a href="/posts/tools-production-ready-code/">Tools for Production Ready Code</a></li>
</ul>

      </div>
    </main>

    <footer>
        <div class="footer-top">
          <div class="container">
            <blockquote>
              <span class="title">“Wisest are they who know they do not know.”</span>
              <attr>
                &mdash; Jostein Gaarder
              </attr>
            </blockquote>
          </div>
        </div>
        <div class="footer-bottom">
          <div class="container">
            <h2>About This Site</h2>
            <p><a href="/">Delicious Reverie</a> is the blog of developer & bookworm <span class="h-card">benjamin read</span>. Set in Lovechild and your system font. Built with <a href="https://www.11ty.dev">Eleventy</a> and <a href="https://slinkity.dev">Slinkity</a>, hosted by Netlify. &copy; Some rights are reserved. This site doesn't use any cookies or other session storage and has no tracking scripts.</p>
          <h3>Where you can find me:</h3>
            <ul class="list-inline">
              <li><a href="https://twitter.com/muzzlehatch_">twitter</a></li>
              <li><a href="https://www.linkedin.com/in/benjaminread1980/">linkedin</a></li>
              <li><a href="https://github.com/endymion1818/">github</a></li>
              <li><a href="/feed.xml">RSS Feed</a></li>
            </ul>
          </div>
        </div>
    </footer>
  </body>
</html>
