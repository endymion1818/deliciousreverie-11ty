<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delaying click event in vanilla JavaScript</title>
    <meta name="description" content="I was inspired by Rachel Nabors&#39; site to add a short delay to users&#39; clicking on a link on my website, so that I could add a brief animation that would run before the redirection took place. Here&#39;s how I did it">
    <meta property="og:site_name" content="Delaying click event in vanilla JavaScript">
    <meta property="og:locale" content="en_GB">
    <meta property="og:type" content="website">
    <meta property="og:description" content="I was inspired by Rachel Nabors&#39; site to add a short delay to users&#39; clicking on a link on my website, so that I could add a brief animation that would run before the redirection took place. Here&#39;s how I did it">
    <meta property="og:title" content="Delaying click event in vanilla JavaScript" />
    <meta property="og:image" content="/img/sharecard-default.png" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@muzzlehatch_" />
    <meta name="twitter:title" content="Delaying click event in vanilla JavaScript" />
    <meta
      name="twitter:description"
      content="I was inspired by Rachel Nabors&#39; site to add a short delay to users&#39; clicking on a link on my website, so that I could add a brief animation that would run before the redirection took place. Here&#39;s how I did it"
    />
    <meta name="twitter:image" content="/img/sharecard-default.png" />
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "NewsArticle",
        "headline": "Delaying click event in vanilla JavaScript",
        "author": {
          "@type": "Person",
          "name": "Benjamin Read"
        },
        "datePublished": "2016-03-22T15:21:21+01:00",
        "image": "/img/sharecard-default.png"
      }
    </script>
    <link rel="icon" href="/img/icon.png" type="image/x-icon">
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Delicious Reverie">
    <link rel="alternate" href="/feed/feed.json" type="application/json" title="Delicious Reverie">
  </head>
  <body>
    <a id="skiplinks" href="#main">Skip to main content</a>
    <p class="themeswitcher">Choose theme:</p>
    <label class="themeswitcher" for="dark">Light</label>
    <input class="themeswitcher" type="radio" id="light" name="colors" value="light">
    <label  class="themeswitcher" for="dark">Dark</label>
    <input  class="themeswitcher" type="radio" id="dark" name="colors" value="dark">
    <header>
      <div class="container">
        <div class="title home"><a href="/">Delicious Reverie</a></div>
        <p class="subtitle">blog of developer &amp; bookworm benjamin read</p>
        <nav>
          <ul class="list-inline">
            <li class="nav-item">
              <a href="/">Home</a>
            </li>
            <li class="nav-item">
              <a href="/about/">About</a>
            </li>
            <li class="nav-item">
              <a href="/links/">Links</a>
            </li>
            <li class="nav-item">
              <a href="/posts/">Archive</a>
            </li>
            <li class="nav-item">
              <a href="/contact/">Contact</a>
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <main class="main tmpl-post">
      
      <div class="container">
        <h1>Delaying click event in vanilla JavaScript</h1>

<time datetime="2016-03-22">22 Mar 2016</time><a href="/tags/javascript/" class="post-tag">javascript</a>

<p><strong>I was inspired by Rachel Nabors' site to add a short delay to users' clicking on a link on my website, so that I could add a brief animation that would run before the redirection took place. Here's how I did it.</strong></p>
<p>&quot;Animation&quot; seems to be the theme of my year. Animation is what I think is going to be one of the big differentiator on websites in the coming months and years. And I really, really love the CSS animations API.</p>
<p>I've used waypoints.js a lot lately so that I can run animations at different stages during the time that a user scrolls around my site. But for my personal blog, I wanted to do something a little trickier.</p>
<p>###My Requirements</p>
<p>I wanted to fade in page elements when the user arrives, and fade them out again when they left. I know that it could potentially have been easier to write this in jQuery using the <code>delay()</code> function, but I decided to go the route of a custom bit of JavaScript. It was a good practice exercise for me, and I don't want to load the jQuery library here unless I have to.</p>
<h3 id="the-code" tabindex="-1">The Code <a class="direct-link" href="#the-code" aria-hidden="true">#</a></h3>
<p>It took me a while to come up with the strategy for this. I started looking at <code>onpageunload()</code>, hoping to add a delay to that. But that's quite locked down, and didn't work for my requirements.</p>
<p>After I had fiddled for a while, I ran up against a brick wall. For some reason, my JS event listener wasn't working properly.</p>
<p>So I turned to StackOverflow and posed the question, which helped immensely, and validated what I was already trying to do. <a href="https://stackoverflow.com/questions/36125391/vanilla-js-delay-click-event-to-add-animation/36126631" title="vanilla JS: delay click event">The thread is here if you'd like to read it</a>.</p>
<h4 id="step-1" tabindex="-1">Step 1 <a class="direct-link" href="#step-1" aria-hidden="true">#</a></h4>
<p>Reading some other posts on Stack Overflow helped me see that I needed to grab <strong>all</strong> of the <code>&lt;a&gt;</code> tags into a variable, then listen for an event.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> links <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>il <span class="token operator">=</span> links<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">&lt;</span> il<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">{</span><br>links<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>onclick <span class="token operator">=</span> clickHandler<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<h4 id="step-2" tabindex="-1">Step 2 <a class="direct-link" href="#step-2" aria-hidden="true">#</a></h4>
<p>Then, I needed a function called <code>clickHandler</code> that would fire on click:</p>
<pre><code>function clickHandler(event) {

event.preventDefault();

var travelTo = this.getAttribute(&quot;href&quot;);
</code></pre>
<p>The first job of this handler was to stop the link from being followed, using <code>preventDefault()</code>, then to grab the link the user was going to so that we could use it later on.</p>
<h4 id="step-3" tabindex="-1">Step 3 <a class="direct-link" href="#step-3" aria-hidden="true">#</a></h4>
<p>The next step was to add my animation class to the elements I wanted:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> animOut <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">"animateOut"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// iterate `animOut` elements</span><br><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> animOut<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>   <span class="token comment">// add `out` `className` to `animOut` element at index `i`</span><br>   animOut<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"out"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>This looks for each element that has a class of <code>animOut</code>, and adds a further class, <code>out</code> when the function runs.</p>
<h4 id="step-4" tabindex="-1">Step 4 <a class="direct-link" href="#step-4" aria-hidden="true">#</a></h4>
<p>Next, we needed to send the user on their way using the <code>travelTo</code> variable we stored earlier and using  the <code>setTimeout</code> function to add a bit of a delay:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> travelTo<span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>I played with the durations quite a bit. It was important for me not to make the animation and/or the delay too long because I thought it would probably be distracting to the user. I reduced it from 1 second to just half a second for this very reason.</p>
<h4 id="the-result" tabindex="-1">The Result <a class="direct-link" href="#the-result" aria-hidden="true">#</a></h4>
<p>Well, click on a link and see it working!!</p>
<p>It was great to be able to work this out, and the Stack Overflow community once again proved to be a fantastic resource.</p>
<p>I must also credit Rachel Nabors for inspiring me, since I first saw this being used <a href="https://rachelnabors.com/" title="Rachel Nabors' portfolio site">on her website</a>.</p>
<p>Here's the full code in a Gist if you'd like to adapt it for your site:</p>

<hr>
<ul><li>Next: <a href="/posts/conversational-user-interface/">The Conversational User Interface</a></li><li>Previous: <a href="/posts/finally-a-fitting-job-title/">Finally [a fitting job title]</a></li>
</ul>

      </div>
    </main>

    <footer>
        <div class="footer-top">
          <div class="container">
            <blockquote>
              <span class="title">“Wisest are they who know they do not know.”</span>
              <attr>
                &mdash; Jostein Gaarder
              </attr>
            </blockquote>
          </div>
        </div>
        <div class="footer-bottom">
          <div class="container">
            <h2>About This Site</h2>
            <p><a href="/">Delicious Reverie</a> is the blog of developer & bookworm <span class="h-card">benjamin read</span>. Set in Lovechild and your system font. Built with <a href="https://www.11ty.dev">Eleventy</a> and <a href="https://slinkity.dev">Slinkity</a>, hosted by Netlify. &copy; Some rights are reserved. This site doesn't use any cookies or other session storage and has no tracking scripts.</p>
          <h3>Where you can find me:</h3>
            <ul class="list-inline">
              <li><a href="https://twitter.com/muzzlehatch_">twitter</a></li>
              <li><a href="https://www.linkedin.com/in/benjaminread1980/">linkedin</a></li>
              <li><a href="https://github.com/endymion1818/">github</a></li>
              <li><a href="/feed.xml">RSS Feed</a></li>
            </ul>
          </div>
        </div>
    </footer>
  </body>
</html>
